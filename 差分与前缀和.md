# 差分与前缀和

## 前缀和

前缀和算法用于差分数组求前缀和，在求部分和时使用。通常在计算完差分数组后，用前缀和算法求出原数组。或在原数组的基础上，求其前缀和数组。

### 一维数组

```c++
//前缀和数组为q[]，差分数组为d[]
q[i] = q[i - 1] + d[i];
```

对于一维数组，原数组的值为后向差分数组之和。

```c++
//前缀和数组为q[]
int l, r;
cin >> l >> r;
int ans = q[l] - q[r+1];
```

对于一维数组，部分和为前缀和数组的值相减。

### 二维数组

```c++
//前缀和数组为q[]，差分数组为d[]
q[i][j] = q[i][j - 1] + q[i - 1][j] - q[i - 1][j - 1] + d[i][j];
```

对于二维数组，原数组的值为后项差分数组之和；

```c++
//前缀和数组为q[]
int x1, y1, x2, y2;
cin >> x1 >> y1 >> x2 >> y2;
int ans = q[x2][y2] + q[x1 - 1][y1 - 1] - q[x1 -1][y2] - q[x2][y1 - 1];
```

对于二维数组，部分和为前缀和数组的值相减。

## 差分

对于差分数组，输入原数组可以用插入差分数组的操作代替，并且输出原数组可以在原差分数组上直接操作。

```c++
//插入差分数组
void insert(int x1, int y1, int x2, int y2, int a){
    d[x1][y1] +=a;
    d[x2+1][y2+1] +=a;
    d[x1][y2+1] -=a;
    d[x2+1][y1] -=a;
    
}
```

```c++
//输入原数组
for(int i = 1; i <= n; i++) 
	for(int j = 1; j <= m; j++){
		int x;
		cin >> x;
		insert(i, j, i, j, x);
	}
```

```c++
//输出原数组
for(int i = 1; i <= n; i++){
	for(int j = 1; j <= m; j++){
		d[i][j] += d[i - 1][j] + d[i][j - 1] - d[i - 1][j - 1] ;
		cout << d[i][j] << ' ';
	}
	cout << endl;
}
```



